*PenetrationTesting*

Security Design Principles
    (My security keeps failing during annual degree exams, lol)
    **Minimize attack surface area**: Remove unnecessary functionality or make it work authenticated users are possible reductions.

    **Separation of dutties**: To control fraud; Who requests a computer can not sign having recieved it; I.e. administrators of a shop should not be users who can buy.

    **Keep security simple**: avoid double negatives and omples architectures when simple and faster appreaches work.

    **Fail securely**: If unexpected events occurr the application should make sure security can not be bypassed.

    **Defense in depth**:  Multiple mitigations for the same issues to prevent a bypass.

    **Fix security issues correctly**: Make sure the root cause is identified and the correct fix applied; Similar bugs can be accross the company's products.

    **Avoid security by obscurity**: nearly always fails when it is the only control. Do not hardcode passwords etc..

    **Don't trust services**: If you integrate with third party services you increase your attack surface and your security is as bad as theirs.

    **Establish secure defaults**: Enable security controls by default, require strong password but user might change it for an unsercure one if they want.

    **Least privilege**: Least amount of pricilege for eqch account to carry out their business processes.


Pentest assessment flavours
    Static analysis (white box)
        Design review
        Static code analysis
        Configuration review

    Dynamic Testing (black box)
        Network infrastructure testing
        Web application testing
        Mobile app test
        Web service testing (e.g., APIs supporting mobile applications)
        Internet-based social engineering
    Gray box (both)
    Physical pentest
    Social engineering test

Network security assessment
    Reconnaissance: Identify networks, hosts, and users of interest
    Vulnerability scanning: Identify potentially exploitable conditions
    Investigation of vulnerabilities and further probing by hand
    Exploitation of vulnerabilities and circumvention of security mechanism
    Elevation of privileges, pivoting, recurse.

Penetration Testing

Terminology
    **Asset**: component that supports information activites that should be protected
    **Vulnerability** weakness that can be used to gain access to an asset
    **Threat** danger to the system that can allow the compromise of an asset
    **Exploit** program/script used to exploit a vulnerability and compromise an asset
    **Risk** impact resulting from compromising an asset
    **Vulnerability assessment** Process of finding all the vulnerabilities
    **Penetration test** exploit all the vulnerabilities

Report
    Executive summary
    Engagement highlights
    Vulnerability report
    Remediation Report
    Findings Summary
    Detailed Summary

Design a botnet C&C.
    Clients use TLS port 443 to connect to the C&C for better chances of bypassing firewalls (looks like HTTP and I can use any protocol).
    Certificate is validated client side, to prevent MITM.
    Use multiple valid certificates, each IP range gets a different one to prevent blacklisting.
    I would also have multiple front ends, the client would try to connect to some of them (each client has multiple front end hardcoded).
    The client polls for new commands every  hour, the time can be changed at polling time, the binary updated, IPS and certificates changed.
    Every time connect to a differnet front end to not look suspicious.
    Use TOR hidden services, generate unique domains for every binary.


How would you secure a new Linux host? How would you secure 10,000 new Linux hosts?
    Disk encryption
    SSH only with a private key, unique per machine per user.
    make sure kernel and packages is  updated
    SELinux with enforcing poly, restricts how apps can interact with kernel, for example file system objects are identified by path name rather tha inode, to prevent symlink attacks to files that would not normally be accessabke
    Disable USB usage
    Lock screen
    Lockdown SSH with a PKI
    Setup your IPTABLES/firewall
    Review log files daily.

What is a "threat model" and how would you design one?
    Threat modelling is used to clearly define potential security threats to an organization/product. Helps designers to think about the threads, it is risk assessment.
    Spoofing -> authentication
    Tampering -> integrity
    repudiation -> non-repudiation
    DoS -> availability
    EoP -> authorization

Top five cyber security threats SMEs should be aware of
    Phishing
    Insecure passwords
    Network vulnerabilities
    Website vulnerabilities
    Mobile malware

Phases Of Network Penetration
    Reconnaissance
    Scanning
    Gaining access
    Keeping access
    Covering tracks

Penetration testing methodologies
    Information System Security Assessment Framework (ISSAF)
    Open Source Security Testing Methodology Manual (OSSTMM).


Planning
    Number of network devices
    Types of network devices
    Known operating systems
    Known websites
    Length of the evaluation

    Location
        Physical or remote

    Organization
        Team leader, network expert, social engineering expert, wifi, web...

    Methodology
        Open Source Security Testing Methodology Manual (OSSTMM)
        Information Systems Security Assessment Framework (ISSAF)

    Statement of Work (SoW)
        The pentesting company presents a SoW, the client accepts it and issues a purchase order. it contains
        Purpose of the assessment
        Type of assessment
        Scope of effort
        Time constraints of the assessment
        Preliminary schedule
        Communication strategy
        Incident handling and response procedures
        Description of the task to be performed
        Deliverables
        Sensitive data handling procedures
        Budget (to include expenses)
        Payment terms
        Points of contact for emergencies


    Report
        Table of contents
        Executive summary
        Methodology used
        Prioritized findings per business unit, group, department
        Finding
        Impact
        Recommendation
        Detailed records and screenshots in the appendix (back of report)

Secure a box
    password protect the boot process before the OS loads (set is BIOS) (important for laptops)
    Password protect CMOS settings
    Disable booting from USB/CD
    Reduce the attack surface of systems by turning off unneeded services.
    Install secure software.
    Use Firewall Software
    Use an Antivirus Scanner (with Real-Time Scanning)
    Use Encryption (SSH/hard drive)
    Configure software settings securely.
    Patch systems regularly and quickly.
    Segment the network into zones of trust and place systems into those zones based their communication needs and Internet exposure.
    Strengthen authentication processes.
    Limit the number (and privileges) of administrators.

1. Planning and preparation
    Identification of contact individuals from both side,
    Opening meeting to confirm the scope, approach, and methodology, and
    Agree to specific test cases and escalation paths.

2. Assessment
    Information Gathering: Using the Internet to find all information about the target, using both technical and nontechnical methods.
    Network Mapping: Identifying all systems and resources within the target network.
    Vulnerability Identification: Activities performed by the assessor to detect vulnerabilities in the target.
    Penetration: Gaining unauthorized access by circumventing the security measures in place and trying to reach as wide a level of access as possible.
    Gaining Access and Privilege Escalation: After successfully exploiting a target system or network, the assessor will try to gain higher level privileges.
    Enumerating Further: Obtaining additional information about processes on the system, with the goal of further exploiting a compromised network or system.
    Compromise Remote Users/Sites: Exploit the trust relationships and communication between remote users and enterprise networks.
    Maintaining Access: Using covert channels, back doors, and rootkits to hide the assessorâ€™s presence on the system or to provide continual access to the compromised system.
    Covering Tracks: Eliminate all signs of compromise by hiding files, clearing logs, defeating integrity checks, and defeating antivirus software.

3. Report
    Management summary
    Project scope
    Penetration test tools used
    Exploits used
    Date and time of the tests
    All outputs of the tools and exploits
    A list of identified vulnerabilities
    Recommendations to mitigate identified vulnerabilities, organized into priorities